# Generated by iptables-save v1.8.3 on Mon Dec 16 16:37:21 2019
*filter
#:INPUT DROP [55:6846]
:INPUT DROP [0:0]
:FORWARD DROP [0:0]

-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
# allow ping in
-A INPUT -p icmp -j ACCEPT
-A OUTPUT -p icmp -j ACCEPT

-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 443 -j ACCEPT
-A INPUT -p udp -m udp --dport 5938 -j ACCEPT
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -p udp -m udp --dport 53 -j ACCEPT

# github
-A OUTPUT -d github.com -j ACCEPT
#-A OUTPUT -d github.githubassets.com -j ACCEPT
#-A OUTPUT -d 140.82.118.4 -j ACCEPT

# Allow git
-A OUTPUT -o eth0 -p tcp --dport 9418 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -i eth0 -p tcp --sport 9418 -m conntrack --ctstate ESTABLISHED -j ACCEPT

# Allow DNS Queries for Git
-A OUTPUT -p udp --dport 53 -m state --state NEW,ESTABLISHED -j ACCEPT
-A INPUT  -p udp --sport 53 -m state --state ESTABLISHED     -j ACCEPT
-A OUTPUT -p tcp --dport 53 -m state --state NEW,ESTABLISHED -j ACCEPT
-A INPUT  -p tcp --sport 53 -m state --state ESTABLISHED     -j ACCEPT

# api.atmo-aura.fr
-A OUTPUT -d 5.149.183.24/32 -p tcp -m tcp -j ACCEPT

# digital.iservices.rte-france.com
-A OUTPUT -d 185.30.132.138/32 -p tcp -m tcp -j ACCEPT

# cnr.tm.fr
-A OUTPUT -d 31.15.26.118/32 -p tcp -m tcp -j ACCEPT

# certains services googles utilis√©s par la cnr
#-A OUTPUT -d fonts.googleapis.com -p tcp -m tcp -j ACCEPT
#-A OUTPUT -d www.googletagmanager.com -p tcp -m tcp -j ACCEPT
#-A OUTPUT -d ssl.google-analytics.com -p tcp -m tcp -j ACCEPT
#-A OUTPUT -d platform.twitter.com -p tcp -m tcp -j ACCEPT
#-A OUTPUT -d syndication.twitter.com -p tcp -m tcp -j ACCEPT
#-A OUTPUT -d pbs.twimg.com -p tcp -m tcp -j ACCEPT

# Prevent DOS Attacks
-A INPUT -p tcp --dport 80 -m limit --limit 25/minute --limit-burst 100 -j ACCEPT

# Decommenter la ligne en dessous pour filtrer 
# toutes les sorties vers le net autres que celles au dessus
#-A OUTPUT -p tcp -m tcp -j DROP
#:OUTPUT ACCEPT [162:17076]
COMMIT
# Completed on Mon Dec 16 16:37:21 2019
